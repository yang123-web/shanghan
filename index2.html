function diagnose() {
  warningDiv.textContent = '';
  resultDiv.style.display = 'none';

  if (selectedSymptoms.length === 0) {
    warningDiv.textContent = '请至少选择一个症状进行诊断';
    return;
  }

  let bestMatch = null;
  let matchedPrescription = null;

  Object.entries(symptomsData).forEach(([syndrome, data]) => {
    const matches = selectedSymptoms.filter((s) => data.symptoms.includes(s)).length;

    if (matches >= 2) {
      bestMatch = syndrome;
      matchedPrescription = Object.values(data.prescriptions)[0];
    }
  });

  if (matchedPrescription) {
    resultDiv.style.display = 'block';
    resultDiv.innerHTML = `
      <h3>诊断结果：</h3>
      <p>证型：${bestMatch}</p>
      <p>推荐方剂：${matchedPrescription.name}</p>
      <p>组成：</p>
      <ul>
        ${matchedPrescription.herbs
          .map((herb) => `<li>${herb.name}：${herb.amount}</li>`)
          .join('')}
      </ul>
      <p>用法：${matchedPrescription.usage}</p>
      <p>说明：${matchedPrescription.description}</p>
    `;
  } else {
    warningDiv.textContent = '未匹配到具体诊断，请重新选择症状';
  }
}
